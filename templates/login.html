<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login page</title>

    <link rel="apple-touch-icon" sizes="180x180" href="/static/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/static/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/static/favicon/favicon-16x16.png">
    <link rel="manifest" href="/static/favicon/site.webmanifest">
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <style>
        
        body {
            padding-top: 60px;
            padding-bottom : 60px;
        }

        .dropdown-toggle {
            color: #f8f9fa;
            text-decoration: none;
        }

        /* FROM MDBOOTSTRAP */

        .custom-color-box {
            background: #275d5797;
        }

        @media (min-width: 768px) {
        .gradient-form {
        height: 100vh !important;
        }
        }
        @media (min-width: 769px) {
        .custom-color-box {
        border-top-right-radius: .3rem;
        border-bottom-right-radius: .3rem;
        }
        }

    </style>
</head>
<body>
    <header class="bg-dark text-white py-3 fixed-top">
        <div class="container d-flex justify-content-between align-items-center">
            <h1 class="h3 mb-0">App Rent Keeper</h1>
        </div>
    </header>

    <section class="h-100 gradient-form" style="background-color: #ffffff;">
        <div class="container py-10 h-100">
        <div class="row d-flex justify-content-center align-items-center h-100">
            <div class="col-xl-12">
            <div class="card rounded-3 text-black">
                <div class="row g-0">
                <div class="col-lg-6">
                    <div class="card-body p-md-5 mx-md-4">
    
                        <form id="login_form">
                            <h1 class="h5 mb-0">Please login to your account</h1>
                            
                            <div class="pt-5 mb-5 pb-6">
                                <div data-mdb-input-init class="form-outline mb-1">
                                    <label for="username_field" class="form-label"></label>
                                    <input type="text" id="username_field" class="form-control" placeholder="Email or username" required/>
                                </div>
            
                                <div data-mdb-input-init class="form-outline mb-4">
                                    <label for="password_field" class="form-label"></label>
                                    <input type="password" id="password_field" class="form-control" placeholder="Password" required/>
                                </div>
                            </div>
        
                            <div class="text-center pt-1 mb-5 pb-1">
                                <button class="btn btn-outline-dark me-3 col-6" id="submit-button" type="submit">Log in</button>
                                <!-- <a class="text-muted" href="#!">Forgot password?</a> -->
                            </div>
        
                            <div class="d-flex align-items-center justify-content-center pb-4">
                                <p class="mb-0 me-3">Don't have an account?</p>
                                <a href="/pages/register" class="btn btn-outline-info">Create new</a>
                            </div>
        
                        </form>
    
                    </div>
                </div>
                <div class="col-lg-6 d-flex align-items-center custom-color-box">
                    <div class="text-white px-3 py-4 p-md-5 mx-md-4">
                    <h4 class="mb-4">App Rent Keeper</h4>
                    <p class="small mb-0">Your safe space to keep track of income and expenses from your properties.</p>
                    </div>
                </div>
                </div>
            </div>
            </div>
        </div>
        </div>
    </section>
</body>
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', (event) => {
        document.getElementById('login_form').addEventListener('submit', async function(event) {
            event.preventDefault();

            const loginData = new FormData();
            loginData.set('username', document.getElementById('username_field').value);
            loginData.set('password', document.getElementById('password_field').value);

            axios.post(
                '/auth/login',
                loginData,
                {
                    headers: {
                        'Content-Type': 'multipart/form-data',
                    },
                },
            )
            .then((response) => {
                console.log('Login successful:', response.data);
                // Redirect user if Login successful
                window.location.href = '/pages/operation/all';
            })
            .catch((error) => {
                console.error('Login failed:', error.response.data);
                
                alert('Login failed: ' + error.response.data.detail);
            });
            
        });
    });
</script>

</html>